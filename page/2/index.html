<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
    
  
  <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />







  

<link href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ç§‹æ³¢çš„ç¨‹åºç”Ÿæ´»" />










<meta name="description" content="Keep running!">
<meta property="og:type" content="website">
<meta property="og:title" content="qiubo&#39;s life">
<meta property="og:url" content="http://bohr.me/page/2/index.html">
<meta property="og:site_name" content="qiubo&#39;s life">
<meta property="og:description" content="Keep running!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="qiubo&#39;s life">
<meta name="twitter:description" content="Keep running!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://bohr.me/page/2/"/>





  <title>qiubo's life</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e81935b4d5ec7e3e782fe240cbd9c21c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">qiubo's life</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Stay Hungry, Stay Foolish</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="æœç´¢..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2016-06-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016-06-reading-notes/" itemprop="url">2016å¹´06æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-06-19T21:52:17+08:00">
                2016-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Service-Wiring-with-Spring-Cloud"><a href="#Service-Wiring-with-Spring-Cloud" class="headerlink" title="Service Wiring with Spring Cloud"></a>Service Wiring with Spring Cloud</h2><p><a href="https://www.infoq.com/articles/spring-cloud-service-wiring" target="_blank" rel="noopener">https://www.infoq.com/articles/spring-cloud-service-wiring</a></p>
<p>è¿™ç¯‡æ–‡ç« èŠåˆ°äº†spring cloudå¦‚ä½•æä¾›é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æœåŠ¡è·¯ç”±èƒ½åŠ›ã€‚ç»“åˆæˆ‘ä»¬çš„ç°çŠ¶è°ˆè°ˆï¼š</p>
<ol>
<li>æœ‰äº›åº”ç”¨æ²¡æœ‰åšåˆ°cloud-readyï¼Œä¾èµ–æœåŠ¡åœ°å€é…ç½®ä¿¡æ¯å†™æ­»ã€‚ã€‚</li>
<li>å†…éƒ¨è¯·æ±‚ç”¨dubboï¼Œå®ç°äº†æœåŠ¡å‘ç°ï¼ŒæœåŠ¡è·¯ç”±ï¼Œå¤§å¤šæ•°é—®é¢˜å·²ç»holdä½äº†</li>
<li>è‡ªç ”çš„é…ç½®ç®¡ç†ç³»ç»Ÿå¯ä»¥åšåˆ°é…ç½®åŠ¨æ€æ›´æ–°ï¼Œæ¯”spring cloud ä¸‹çš„<code>Enabling Dynamic Refresh</code>åšæ³•ä¼˜é›…å¤šä¸å°‘</li>
<li>è¿˜éœ€è¦æä¾›httpæœåŠ¡çš„æœåŠ¡æ³¨å†Œã€å‘ç°èƒ½åŠ›ã€‚ä¸ºå¤–éƒ¨httpè´Ÿè½½å‡è¡¡ã€å†…éƒ¨httpæœåŠ¡ä¾èµ–æä¾›æœåŠ¡å‘ç°ã€æœåŠ¡è·¯ç”±èƒ½åŠ›</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2016-05-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016-05-reading-notes/" itemprop="url">2016å¹´05æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-05-11T21:52:17+08:00">
                2016-05-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="NGINX-Plus-vs-F5-BIG-IP-A-Price-Performance-Comparison"><a href="#NGINX-Plus-vs-F5-BIG-IP-A-Price-Performance-Comparison" class="headerlink" title="NGINX Plus vs. F5 BIG-IP: A Price-Performance Comparison"></a>NGINX Plus vs. F5 BIG-IP: A Price-Performance Comparison</h2><p>å½“é€šç”¨ç¡¬ä»¶çš„å¤„ç†èƒ½åŠ›è¶Šæ¥è¶Šå¼ºï¼Œä¸“æœ‰èŠ¯ç‰‡çš„ä½¿ç”¨åœºæ™¯ä¼šè¶Šæ¥è¶Šå°‘ï¼Œç¡¬ä»¶æä¾›å•†ä¼šé€æ­¥è½¬å‹ä¸ºè½¯ä»¶æä¾›å•†ã€‚ä»¥å‰ä¹Ÿå¬åˆ°ä¸å°‘å£°éŸ³ï¼Œæ¯”å¦‚æŸç¡¬ä»¶è´Ÿè½½è®¾å¤‡ï¼Œé€šç”¨cpuä¸­é›†æˆäº†<code>LVS</code>.</p>
<p>æœªæ¥æˆ‘ä»¬å¯èƒ½ã€ä¼šã€åº”è¯¥åºŸå¼ƒæ‰å¤§éƒ¨åˆ†è´Ÿè½½å‡è¡¡è®¾å¤‡å§ã€‚</p>
<h2 id="Microservices-Oracle-A-Bright-Future"><a href="#Microservices-Oracle-A-Bright-Future" class="headerlink" title="Microservices + Oracle: A Bright Future"></a>Microservices + Oracle: A Bright Future</h2><p>è¿™ç¯‡æ–‡ç« å¯¹å¾®æœåŠ¡çš„è®²è¿°å¾ˆå…¨é¢ã€‚éƒ¨åˆ†è§‚ç‚¹ä¸è°‹è€Œåˆâ€¦</p>
<p><iframe src="//www.slideshare.net/slideshow/embed_code/key/y5r6fWXDjIHS9I" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/KellyGoetsch/microservices-oracle-a-bright-future" title="Microservices + Oracle: A Bright Future" target="_blank">Microservices + Oracle: A Bright Future</a> </strong> from <strong><a href="//www.slideshare.net/KellyGoetsch" target="_blank">Kelly Goetsch</a></strong> </div></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2016-04-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016-04-reading-notes/" itemprop="url">2016å¹´04æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-04-05T21:52:17+08:00">
                2016-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Contended-FOR-false-sharing"><a href="#Contended-FOR-false-sharing" class="headerlink" title="@Contended FOR false sharing"></a><a name="false-sharing">@Contended FOR false sharing</a></h2><p>ABOUT False Sharingï¼š</p>
<blockquote>
<blockquote>
<p>Most high performance processors, insert a cache buffer between slow memory and the high speed registers of the CPU. Accessing a memory location causes a slice of actual memory (a cache line) containing the memory location requested to be copied into the cache. Subsequent references to the same memory location or those around it can probably be satisfied out of the cache until the system determines it is necessary to maintain the coherency between cache and memory.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>Each update of an individual element of a cache line marks the line as invalid. Other processors accessing a different element in the same line see the line marked as invalid. They are forced to fetch a more recent copy of the line from memory or elsewhere, even though the element accessed has not been modified. This is because cache coherency is maintained on a cache-line basis, and not for individual elements. As a result there will be an increase in interconnect traffic and overhead.</p>
</blockquote>
</blockquote>
<p>å½“ä¸‹åˆ—æ¡ä»¶æ»¡è¶³æ—¶ï¼ŒFalse sharingæå¤§é™ä½äº†å¹¶å‘æ€§èƒ½ã€‚</p>
<ul>
<li>Shared data is modified by multiple processors.</li>
<li>Multiple processors update data within the same cache line.</li>
<li>This updating occurs very frequently (for example, in a tight loop).</li>
</ul>
<p>java8 å¼•å…¥äº†<code>@Contended</code>ï¼Œåœ¨å¯¹è±¡ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ’å…¥<code>padding</code>,é˜²æ­¢å¤šä¸ªæ•°æ®åœ¨ä¸€ä¸ªcache lineä¸­ã€‚</p>
<p><code>https://github.com/m0wfo/false-sharing-demo</code>æµ‹è¯•ç»“æœï¼š</p>
<pre><code>[0] % java -XX:-RestrictContended -jar target/false-sharing-demo-1.0.0-SNAPSHOT.jar plain
Updating unpadded version 1B times Took: 55.457223514sec
Updating @Contended version 1B times Took: 7.387646696sec
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2016-02-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016-02-reading-notes/" itemprop="url">2016å¹´02æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-02-01T21:52:17+08:00">
                2016-02-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æ¯ä¸ªæ¶æ„å¸ˆéƒ½åº”è¯¥ç ”ç©¶ä¸‹åº·å¨å®šå¾‹"><a href="#æ¯ä¸ªæ¶æ„å¸ˆéƒ½åº”è¯¥ç ”ç©¶ä¸‹åº·å¨å®šå¾‹" class="headerlink" title="æ¯ä¸ªæ¶æ„å¸ˆéƒ½åº”è¯¥ç ”ç©¶ä¸‹åº·å¨å®šå¾‹"></a><a name="about-arch"><a href="http://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&amp;mid=408286995&amp;idx=1&amp;sn=1634698023c48b754d42af69cee2ab32" target="_blank" rel="noopener">æ¯ä¸ªæ¶æ„å¸ˆéƒ½åº”è¯¥ç ”ç©¶ä¸‹åº·å¨å®šå¾‹</a></a></h2><p>æœ€è¿‘åœ¨åš<code>DEVOPS</code>,çœ‹æŠ€æœ¯çš„å‡ºå‘ç‚¹æœ‰æ‰€å˜åŒ–ï¼Œæ­£å¥½çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæ€»ç»“ä¸‹è‡ªå·±ã€‚</p>
<h3 id="1-ç³»ç»Ÿæ¶æ„çš„ç›®æ ‡æ˜¯è§£å†³åˆ©ç›Šç›¸å…³è€…çš„å…³æ³¨ç‚¹ã€‚"><a href="#1-ç³»ç»Ÿæ¶æ„çš„ç›®æ ‡æ˜¯è§£å†³åˆ©ç›Šç›¸å…³è€…çš„å…³æ³¨ç‚¹ã€‚" class="headerlink" title="1. ç³»ç»Ÿæ¶æ„çš„ç›®æ ‡æ˜¯è§£å†³åˆ©ç›Šç›¸å…³è€…çš„å…³æ³¨ç‚¹ã€‚"></a>1. ç³»ç»Ÿæ¶æ„çš„ç›®æ ‡æ˜¯è§£å†³åˆ©ç›Šç›¸å…³è€…çš„å…³æ³¨ç‚¹ã€‚</h3><blockquote>
<blockquote>
<p>æ¶æ„å…¶å®æ˜¯å‘ç°åˆ©ç›Šç›¸å…³è€…ï¼ˆstakeholderï¼‰ï¼Œç„¶åè§£å†³ä»–ä»¬çš„å…³æ³¨ç‚¹ï¼ˆconcernsï¼‰</p>
<p>ä¸šåŠ¡æ–¹ï¼Œäº§å“ç»ç†ï¼Œå®¢æˆ·/ç”¨æˆ·ï¼Œå¼€å‘ç»ç†ï¼Œå·¥ç¨‹å¸ˆï¼Œé¡¹ç›®ç»ç†ï¼Œæµ‹è¯•äººå‘˜ï¼Œè¿ç»´äººå‘˜ï¼Œäº§å“è¿è¥äººå‘˜ç­‰ç­‰éƒ½æœ‰å¯èƒ½æ˜¯åˆ©ç›Šç›¸å…³è€…ï¼Œæ¶æ„å¸ˆè¦å……åˆ†å’Œåˆ©ç›Šç›¸å…³è€…æ²Ÿé€šï¼Œæ·±å…¥ç†è§£ä»–ä»¬çš„å…³æ³¨ç‚¹å’Œç—›ç‚¹ï¼Œå¹¶å‡ºæ¶æ„è§£å†³è¿™äº›å…³æ³¨ç‚¹ã€‚</p>
</blockquote>
</blockquote>
<p>æ¶æ„å¸ˆåœ¨è¿™é‡Œä¹Ÿå®šä½ä¸ºä¸€ä¸ªå¥½çš„éœ€æ±‚åˆ†æå¸ˆï¼Œä½†æ˜¯æ¶æ„å¸ˆå¾€å¾€ä¼šä»è‡ªå·±çš„è§’åº¦(åˆ©ç›Šç›¸å…³æˆ–è€…ç«‹åœºç›¸å…³)æ¥è®¾è®¡ã€‚æˆ‘ä¹‹å‰ä¸€ç›´åšå¼€å‘å·¥ä½œï¼Œåœ¨æŠ€æœ¯é€‰å‹æˆ–è€…ç ”ç©¶æ—¶ï¼Œå¯¹äºå¯è¿ç»´æ€§è€ƒè™‘å¾—æ¯”è¾ƒå°‘ï¼Œåœ¨ç—›è¿‡å‡ æ¬¡åï¼Œå‘ç°ç›‘æ§çš„ä»·å€¼ï¼Œæ¥è¡¥å……ç›¸å…³<code>metrics</code>çš„èƒ½åŠ›ã€‚</p>
<h3 id="2-å…³æ³¨éåŠŸèƒ½æ€§éœ€æ±‚"><a href="#2-å…³æ³¨éåŠŸèƒ½æ€§éœ€æ±‚" class="headerlink" title="2. å…³æ³¨éåŠŸèƒ½æ€§éœ€æ±‚"></a>2. å…³æ³¨éåŠŸèƒ½æ€§éœ€æ±‚</h3><ul>
<li>easy to separate</li>
<li>easy to understand</li>
<li>easy to extend</li>
<li>easy to change</li>
<li>easy to replace</li>
<li>easy to deploy</li>
<li>easy to scale</li>
<li>easy to recover</li>
<li>easy to connect</li>
<li>easy to afford</li>
</ul>
<blockquote>
<blockquote>
<p>Architecture represents the significant design decisions that shape a system, where significant is measured by cost of change.</p>
<p>æ¶æ„çš„ç›®æ ‡æ˜¯ç”¨äºç®¡ç†å¤æ‚æ€§ã€æ˜“å˜æ€§å’Œä¸ç¡®å®šæ€§ï¼Œä»¥ç¡®ä¿åœ¨é•¿æœŸçš„ç³»ç»Ÿæ¼”åŒ–è¿‡ç¨‹ä¸­ï¼Œä¸€éƒ¨åˆ†æ¶æ„çš„å˜åŒ–ä¸ä¼šå¯¹æ¶æ„çš„å…¶å®ƒéƒ¨åˆ†äº§ç”Ÿä¸å¿…è¦çš„è´Ÿé¢å½±å“ã€‚</p>
</blockquote>
</blockquote>
<p>è¿™é‡Œè¡¥å……ä¸€ç‚¹ï¼Œéœ€è¦è€ƒè™‘<code>easy to find the problem</code>ã€‚é™¤äº†åˆç†çš„è§„åˆ’æ—¥å¿—ï¼Œæˆ‘ä»¬è¦åšåˆ°<code>failfast</code>ã€‚å½“å…³é”®èµ„æºä¾èµ–æ¡ä»¶ä¸æ»¡è¶³ï¼Œæˆ‘ä»¬æœ€å¥½æ˜¯æŠŠé—®é¢˜ç”¨æœ€æ˜¾ç¤ºçš„æ–¹å¼æš´éœ²å‡ºæ¥ï¼Œè€Œä¸æ˜¯è®©å®ƒåœ¨é‚£é‡Œä¸€ç›´æŠ¥é”™ã€‚</p>
<h3 id="3-æ¶æ„çš„è¿­ä»£å’Œæ¼”åŒ–æ€§"><a href="#3-æ¶æ„çš„è¿­ä»£å’Œæ¼”åŒ–æ€§" class="headerlink" title="3. æ¶æ„çš„è¿­ä»£å’Œæ¼”åŒ–æ€§"></a>3. æ¶æ„çš„è¿­ä»£å’Œæ¼”åŒ–æ€§</h3><blockquote>
<blockquote>
<p>åšæŠ€æœ¯æ¶æ„çš„éƒ½æœ‰ç‚¹å®Œç¾ä¸»ä¹‰å€¾å‘ï¼Œä¸€å¼€å§‹å¾€å¾€å–œæ¬¢æ±‚å¤§æ±‚å…¨ï¼Œå¿½è§†æ¶æ„çš„æ¼”åŒ–å’Œè¿­ä»£æ€§ï¼Œè¿™ç§å€¾å‘æ˜“é€ äº§å“å’Œç”¨æˆ·ä¹‹é—´ä¸èƒ½å½¢æˆæœ‰æ•ˆå¿«é€Ÿçš„åé¦ˆï¼Œäº§å“ä¸æ»¡è¶³æœ€ç»ˆç”¨æˆ·éœ€æ±‚.</p>
<p>åœ¨ç³»ç»ŸçœŸæ­£åœ°æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ä¹‹å‰ï¼Œå†å¥½çš„æ¶æ„éƒ½åªæ˜¯å‡è®¾ï¼Œäº§å“è¶Šæ™šè¢«ä½¿ç”¨è€…ä½¿ç”¨ï¼Œå¤±è´¥çš„æˆæœ¬å’Œé£é™©å°±è¶Šé«˜ï¼Œè€Œå°æ­¥è¡Œè¿›ï¼Œé€šè¿‡MVPå¿«é€Ÿå®éªŒï¼Œè·å–å®¢æˆ·åé¦ˆï¼Œè¿­ä»£æ¼”åŒ–äº§å“ï¼Œèƒ½æœ‰æ•ˆåœ°å‡å°‘å¤±è´¥çš„æˆæœ¬å’Œé£é™©ã€‚</p>
</blockquote>
</blockquote>
<p>å¥½çš„æ¶æ„æ˜¯è¡å˜å‡ºæ¥çš„ï¼Œè€Œéè®¾è®¡å‡ºæ¥çš„ã€‚</p>
<h3 id="4-æ„å»ºé—­ç¯åé¦ˆæ¶æ„"><a href="#4-æ„å»ºé—­ç¯åé¦ˆæ¶æ„" class="headerlink" title="4. æ„å»ºé—­ç¯åé¦ˆæ¶æ„"></a>4. æ„å»ºé—­ç¯åé¦ˆæ¶æ„</h3><blockquote>
<blockquote>
<p>ç¬¬ä¸€æ¡é“è·¯ï¼Œç³»ç»Ÿæ€ç»´ï¼Œå¼€å‘é©±åŠ¨çš„ç»„ç»‡æœºä½“ï¼Œå…¶èƒ½åŠ›ä¸æ˜¯åˆ¶ä½œè½¯ä»¶ï¼Œè€Œæ˜¯æŒç»­çš„äº¤ä»˜å®¢æˆ·ä»·å€¼ï¼Œæ¶æ„å¸ˆéœ€è¦æœ‰å…¨å±€è§†è§’å’Œç³»ç»Ÿæ€ç»´ï¼ˆSystem Thinkingï¼‰ï¼Œæ·±å…¥ç†è§£æ•´ä¸ªä»·å€¼äº¤ä»˜é“¾ï¼Œä»ä¸šåŠ¡éœ€æ±‚ã€ç ”å‘ã€æµ‹è¯•ã€é›†æˆï¼Œåˆ°éƒ¨ç½²è¿ç»´ï¼Œè¿™æ¡ä»·å€¼é“¾çš„æ•ˆç‡å¹¶ä¸ä¾èµ–äºå•ä¸ªæˆ–è€…å‡ ä¸ªç¯èŠ‚ï¼Œå±€éƒ¨ä¼˜åŒ–çš„ç»“æœå¾€å¾€æ˜¯å…¨å±€å—æŸï¼Œæ¶æ„å¸ˆè¦ç«™åœ¨ç³»ç»Ÿé«˜åº¦å»ä¼˜åŒ–æ•´ä¸ªä»·å€¼äº¤ä»˜é“¾ï¼Œè®©ä¼ä¸šå’Œå®¢æˆ·ä¹‹é—´å½¢æˆå¿«é€Ÿå’Œé«˜æ•ˆçš„ä»·å€¼ä¼ é€’ã€‚</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>ç¬¬äºŒæ¡é“è·¯ï¼Œå¼ºåŒ–åé¦ˆç¯ï¼Œä»»ä½•è¿‡ç¨‹æ”¹è¿›çš„ç›®æ ‡éƒ½æ˜¯åŠ å¼ºå’Œç¼©çŸ­åé¦ˆç¯ã€‚</p>
<p>æ”¶é›†-&gt;æµ‹é‡-&gt;è°ƒæ•´-&gt;é—­ç¯é‡å¤ï¼Œåœ¨æœ‰æµ‹é‡æ•°æ®å’Œåé¦ˆçš„åŸºç¡€ä¸Šï¼Œç³»ç»Ÿã€åº”ç”¨ã€æµç¨‹å’Œå®¢æˆ·ä½“éªŒæ‰æœ‰å¯èƒ½è·å¾—æŒç»­çš„æå‡å’Œæ”¹å–„ï¼Œå¦åˆ™æ²¡æœ‰æ•°æ®çš„æ‰€è°“æ”¹è¿›åªèƒ½é æ‹è„‘è¢‹æˆ–è€…è¯´çŒœæµ‹ã€‚</p>
</blockquote>
</blockquote>
<p>è¿™é‡Œæåˆ°ç›‘æ§çš„é‡è¦æ€§ï¼Œ<strong>æ²¡æœ‰æµ‹é‡ï¼Œå°±æ²¡æœ‰æ”¹è¿›å’Œæå‡</strong>ï¼Œ<a href="http://www.infoq.com/cn/articles/metrics-driven-development" target="_blank" rel="noopener">MDD</a>è¿™åæ–‡ç« æœ‰ç‚¹æ„æ€ï¼Œé€šè¿‡åˆ†å±‚å’Œå¯ç”¨çš„æ€§èƒ½æŒ‡æ ‡è®©å¼€å‘äººå‘˜äº†è§£é¡¹ç›®ä¸šåŠ¡æ–¹é¢çš„å†…å®¹ï¼Œåè¿‡æ¥ï¼Œä¸šåŠ¡äººå‘˜ä¹Ÿèƒ½ç†è§£é¡¹ç›®æŠ€æœ¯æ–¹é¢çš„å†…å®¹ï¼Œçœ‹åˆ°å¼€å‘äººå‘˜æ‰€é¢ä¸´çš„é—®é¢˜å’Œæˆ‘ä»¬çš„è´Ÿè½½å±€é™ã€‚</p>
<blockquote>
<blockquote>
<p>ç¬¬ä¸‰æ¡é“è·¯ï¼Œé¼“åŠ±å‹‡äºæ‰¿æ‹…è´£ä»»ï¼Œå†’é™©è¯•é”™å’ŒæŒç»­æå‡çš„æ–‡åŒ–ã€‚</p>
</blockquote>
</blockquote>
<p>æœ€åï¼Œè´´ä¸Šä¸€å¼ å…³äº<code>DevOps</code>çš„å›¾ã€‚</p>
<p><img src="/2016-02-reading-notes/devops.jpg" alt=""></p>
<h2 id="æ—¶é—´åºåˆ—æ•°æ®åº“çš„ç§˜å¯†"><a href="#æ—¶é—´åºåˆ—æ•°æ®åº“çš„ç§˜å¯†" class="headerlink" title="æ—¶é—´åºåˆ—æ•°æ®åº“çš„ç§˜å¯†"></a>æ—¶é—´åºåˆ—æ•°æ®åº“çš„ç§˜å¯†</h2><p><a href="http://www.infoq.com/cn/articles/database-timestamp-01" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/database-timestamp-01</a></p>
<p><a href="http://www.infoq.com/cn/articles/database-timestamp-01" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/database-timestamp-01</a></p>
<p><a href="http://www.infoq.com/cn/articles/database-timestamp-01" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/database-timestamp-01</a></p>
<p>æ­¤æ–‡è®²æ˜ç™½äº†æ—¶åºæ•°æ®åº“ï¼Œæœ€è¿‘ä¹Ÿåœ¨çº ç»“è¿™ä¸ªäº‹(åŸæ¥ä¸€ç›´çœ‹å¥½opentsdbï¼Œä½†æ˜¯æ²¡æœ‰æ·±å…¥è°ƒç ”opentsdbçš„ç»†èŠ‚ï¼Œå¯¹esä¹Ÿä¸æ˜¯å¤ªäº†è§£)ï¼Œè¿™é‡Œæ€»ç»“ä¸‹å…¨æ–‡ã€‚</p>
<p>æ—¶é—´åºåˆ—æ•°æ®åº“é™¤äº†æä¾›æŸ¥è¯¢èƒ½åŠ›å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿæä¾›åœ¨æŸ¥è¯¢é˜¶æ®µåšèšåˆèƒ½åŠ›ã€‚</p>
<p>èšåˆæœ‰æœ‰ä¸‰ä¸ªæ­¥éª¤:</p>
<ul>
<li>ç”¨ç´¢å¼•æ£€ç´¢å‡ºè¡Œå·(æœç´¢å¼•æ“æœ€æ“…é•¿)</li>
<li>ä»ä¸»å­˜å‚¨æŒ‰è¡Œå·åŠ è½½åˆ—(åˆ—å¼å­˜å‚¨æœ€åˆé€‚)</li>
<li>è®¡ç®—(åˆ†å¸ƒå¼è®¡ç®—åˆ—æ•°æ®)</li>
</ul>
<p><code>ES</code>åœ¨è¿™ä¸‰ä¸ªæ­¥éª¤ä¸Šéƒ½åšå¾—å¾ˆå¥½ã€‚</p>
<ol>
<li><p>å¦‚ä½•å¿«é€Ÿæ£€ç´¢ï¼Ÿ</p>
<p> <img src="http://cdn3.infoqstatic.com/statics_s2_20160217-0123u3/resource/articles/database-timestamp-02/zh/resources/0820002.jpg" alt=""></p>
<p> luceneå€’æ’ç´¢å¼•ç”±<code>Term index</code>-&gt;<code>Term Dictionary</code>-&gt;<code>Posting List</code>æ„æˆã€‚<code>TI</code>æ˜¯å¯¹<code>TD</code>åšçš„ç´¢å¼•ï¼Œå®ç°å¯¹Termçš„å¿«é€ŸæŸ¥æ‰¾ã€‚Mysqlä½¿ç”¨b-treeæ’åºå­˜å‚¨<code>TD</code>åœ¨ç£ç›˜ä¸Š;<code>Lucene</code>å¢åŠ äº†<code>TI</code>ä¿å­˜åœ¨å†…å­˜ä¸­ï¼ŒæŸ¥è¯¢æ•ˆç‡æ›´é«˜ã€‚</p>
</li>
<li><p>å¦‚ä½•è”åˆç´¢å¼•æŸ¥è¯¢ï¼Ÿ</p>
<p> å¯¹äº<code>age=18 AND gender=å¥³</code>çš„æŸ¥è¯¢è¿‡æ»¤ã€‚mysqlçš„åšæ³•æ˜¯(å¦‚æœä¸¤ä¸ªåˆ—éƒ½å»ºç«‹äº†ç´¢å¼•ï¼Œå½“ç„¶genderåˆ—åšç´¢å¼•åœ¨mysqlä¸Šæ²¡æœ‰ä»€ä¹ˆåµç”¨)å…ˆåœ¨ç´¢å¼•ä¸Šæ‰¾<code>age=18</code>çš„æ‰€æœ‰idï¼Œç„¶åéå†idåŒ¹é…ã€‚</p>
<p> Elasticsearchæ”¯æŒï¼š</p>
<ul>
<li><p>ä½¿ç”¨skip listæ•°æ®ç»“æ„ã€‚åŒæ—¶éå†genderå’Œageçš„posting listï¼Œäº’ç›¸skipï¼›</p>
<p>  åˆ©ç”¨skip list(Level0å­˜å‚¨åŸå§‹æœ‰åºæ•°æ®ï¼Œlevel1å­˜å‚¨éƒ¨åˆ†æ•°æ®ï¼ŒæŸ¥æ‰¾æ—¶ä»level1è·³è¿‡éƒ¨åˆ†æ•°æ®)ï¼Œè·³è¿‡äº†éå†çš„æˆæœ¬,å¹¶ä¸”ç”¨<code>Frame of Reference</code>(è®¡ç®—å·®å€¼ï¼Œåˆ†å—åï¼Œæ¯ä¸ªå—å†…éƒ¨é€‰æ‹©åˆé€‚çš„bitæ¥å­˜å‚¨)å‹ç¼©å­˜å‚¨ã€‚</p>
</li>
<li><p>ä½¿ç”¨bitsetæ•°æ®ç»“æ„ï¼Œå¯¹genderå’Œageä¸¤ä¸ªfilteråˆ†åˆ«æ±‚å‡ºbitsetï¼Œå¯¹ä¸¤ä¸ªbitsetåšANæ“ä½œã€‚</p>
<p>  å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œbitsetéå¸¸ç¨€ç–ï¼Œbitsetå‹ç¼©ç©ºé—´å¾ˆå¤§ã€‚luceneé‡‡ç”¨<code>Roaring Bitmap</code>,ç®—æ³•ä¹Ÿæœ‰ç‚¹æ„æ€ï¼š<br>  è®¡ç®—N/65536å’ŒN%65536çš„å€¼ï¼ŒæŠŠN/65536ç›¸åŒçš„åˆ†ä¸ºä¸€ä¸ªç»„ï¼Œåˆ†ç»„åæ ¹æ®æ¯ä¸ªç»„çš„æƒ…å†µç”¨shortæ•°å­—æˆ–è€…bitsetã€‚</p>
</li>
</ul>
</li>
<li><p>å¦‚ä½•å‡å°‘æ–‡æ¡£æ•°ï¼Ÿ</p>
<p> ä¸€èˆ¬é‡‡ç”¨æ•°æ®åº“ä¼šåˆå¹¶ï¼ŒæŠŠå¤šè¡Œæ•°æ®åˆå¹¶æˆä¸€è¡Œï¼Œæ¯”å¦‚æŠŠåŸæ¥ç²¾ç¡®åˆ°ç§’çš„æ•°æ®åˆå¹¶ä¸ºåˆ†ã€‚<code>ES</code>ä¸­ä½¿ç”¨å†…åµŒæ–‡æ¡£(Nested Document)å®ç°å…¬å…±å­—æ®µçš„å»ä»(æ¯”å¦‚åº”ç”¨åã€ipã€ç¯å¢ƒæ ‡è¯†ã€metricsname)</p>
</li>
<li><p>å¦‚ä½•åŠ è½½æ›´å¿«ï¼Ÿ</p>
<p> å¦‚ä½•åˆ©ç”¨ç´¢å¼•å’Œä¸»å­˜å‚¨ï¼Œæ˜¯ä¸€ç§ä¸¤éš¾çš„é€‰æ‹©ã€‚</p>
<ul>
<li><p>é€‰æ‹©ä¸ä½¿ç”¨ç´¢å¼•ï¼Œåªä½¿ç”¨ä¸»å­˜å‚¨ï¼šé™¤éæŸ¥è¯¢çš„å­—æ®µå°±æ˜¯ä¸»å­˜å‚¨çš„æ’åºå­—æ®µï¼Œå¦åˆ™å°±éœ€è¦é¡ºåºæ‰«ææ•´ä¸ªä¸»å­˜å‚¨ã€‚</p>
<p>   è¿™è¦æ±‚æ•°æ®å­˜å‚¨æŒ‰ç…§æŸ¥è¯¢æ¡ä»¶æ¥é€‰æ‹©ä¸»é”®(mysqlä¸­çš„èšç°‡ç´¢å¼•)ï¼Œå¦‚æœæŸ¥è¯¢æ¡ä»¶å¾ˆå¤šï¼Œä¼šæ‰«ææ•´ä¸ªæ–‡ä»¶ã€‚</p>
</li>
<li><p>é€‰æ‹©ä½¿ç”¨ç´¢å¼•ï¼Œç„¶åç”¨æ‰¾åˆ°çš„row idå»ä¸»å­˜å‚¨åŠ è½½æ•°æ®ï¼šè¿™æ ·ä¼šå¯¼è‡´å¾ˆå¤šç¢ç‰‡åŒ–çš„éšæœºè¯»æ“ä½œã€‚</p>
<p>  ä»ç¡¬ç›˜ä¸Šéšæœºè¯»å†™æ€§èƒ½ä½</p>
</li>
</ul>
<p>Luceneåº•å±‚è¯»å–æ–‡ä»¶åŸºäºmmapï¼Œå……åˆ†åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„ç‰¹æ€§æ¥æ˜ å°„æ–‡ä»¶åˆ°å†…å­˜(åˆ—å¼å­˜å‚¨çš„ä¼˜ç‚¹æ˜¯æ¯åˆ—ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨mmapï¼ŒåŠ è½½éœ€è¦çš„åˆ—)ï¼Œæ‰€ä»¥è¿˜æ˜¯å†…å­˜è¶Šå¤§è¶Šå¥½ã€‚</p>
</li>
<li><p>åˆ†å¸ƒå¼èšåˆå¦‚ä½•åšå¾—å¿«ï¼Ÿ</p>
<p> é€šè¿‡æ•°æ®åˆ†ç‰‡ï¼ŒæŠŠæ•°æ®åˆ†æ•£åˆ°å¤šå°æœºå™¨ã€‚åœ¨è®¡ç®—æ—¶ï¼Œå„ä¸ªèŠ‚ç‚¹indexè®¡ç®—èšåˆç»“æœï¼Œç„¶åæ±‡æ€»ååœ¨èšåˆã€‚è¿™æ ·ä¹Ÿå‡å°‘äº†ç½‘ç»œå¸¦å®½ï¼Œå……åˆ†åˆ©ç”¨äº†å„ä¸ªèŠ‚ç‚¹çš„è®¡ç®—èƒ½åŠ›ã€‚</p>
</li>
<li><p>ä¸ºä»€ä¹ˆæ—¶é—´åºåˆ—éœ€è¦æ›´å¤æ‚çš„èšåˆï¼Ÿ</p>
<p> é€šå¸¸ä¼šæœ‰é™é¢‘(æ¯”å¦‚åŸæ¥æ—¶é—´ç²¾ç¡®åˆ°ç§’ï¼Œç°åœ¨éœ€è¦ä»¥åˆ†ä¸ºå•ä½)å’Œé™ç»´(æ¯”å¦‚åŸæ¥æœ‰åœ°åŸŸçº¬åº¦ï¼Œç»Ÿè®¡æ—¶æ±‚æ‰€æœ‰åœ°åŒº)éœ€æ±‚ã€‚<code>ES</code>æ”¯æŒPipeline Aggregationå¯ä»¥å®ç°æ•°æ®åœ¨èšåˆä¹‹åå†åšèšåˆï¼Œèƒ½æ»¡è¶³å¤šæ¬¡èšåˆçš„éœ€æ±‚ã€‚</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/docker/" itemprop="url">docker</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-01-01T21:52:17+08:00">
                2016-01-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-dockeré…ç½®"><a href="#1-dockeré…ç½®" class="headerlink" title="1. dockeré…ç½®"></a>1. dockeré…ç½®</h3><p>åœ¨mac osxä¸­ï¼Œdocker deamonè¿è¡Œåœ¨virtualboxè™šæ‹Ÿæœºä¸­ï¼Œdocker clientå’Œè™šæ‹Ÿæœºä¸­çš„docker deamonäº¤äº’ã€‚</p>
<h4 id="1-1-ç¯å¢ƒé…ç½®"><a href="#1-1-ç¯å¢ƒé…ç½®" class="headerlink" title="1.1 ç¯å¢ƒé…ç½®"></a>1.1 ç¯å¢ƒé…ç½®</h4><pre><code>#é…ç½®dockerç¯å¢ƒå˜é‡
eval &quot;$(docker-machine env default)&quot;
#é…ç½®dockerå¯åŠ¨alias    
alias docker-start=&apos;docker-machine start default&apos;
#é…ç½®dockerå…³é—­alias
alias docker-stop=&quot;docker-machine stop default&quot;
</code></pre><p>å¯åŠ¨å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code>docker-start
docker-stop
</code></pre><h4 id="1-2-é…ç½®é•œåƒç§æœ"><a href="#1-2-é…ç½®é•œåƒç§æœ" class="headerlink" title="1.2 é…ç½®é•œåƒç§æœ"></a>1.2 é…ç½®é•œåƒç§æœ</h4><p>æµ‹è¯•ç¯å¢ƒä¸­ç§æœæä¾›æœåŠ¡å¦‚ä¸‹ï¼š</p>
<pre><code>#docker registry ui
http://192.168.46.21:10005/
#docker registry restful api
http://192.168.46.21:5000/v2/_catalog
</code></pre><p>ä¸‹é¢é…ç½®docker registryç§æœä¸º192.168.46.21ï¼š</p>
<pre><code>#ç™»é™†åˆ°server
docker-machine ssh default

#ä¿®æ”¹/var/lib/boot2docker/profile
--insecure-registry 192.168.46.21:5000
--registry-mirror http://192.168.46.21:5000
</code></pre><p>å›½å†…docker mirrorï¼š</p>
<pre><code>https://lug.ustc.edu.cn/wiki/mirrors/help/docker
http://0b929cdf.m.daocloud.io
</code></pre><h3 id="2-docker-å¸¸ç”¨å‘½ä»¤"><a href="#2-docker-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="2. docker å¸¸ç”¨å‘½ä»¤"></a>2. docker å¸¸ç”¨å‘½ä»¤</h3><p><img src="/docker/docker-command.jpg" alt=""></p>
<pre><code>#æ‹‰å–é•œåƒ
docker pull yiji/java8:1.0

#æŸ¥çœ‹é•œåƒå†å²,èƒ½çœ‹åˆ°dockeré•œåƒå±‚çš„ç»†èŠ‚
docker history  yiji/java8:1.0

#åˆ é™¤é•œåƒ
docker rmi -f yiji/centos7:latest

#åˆ é™¤å®¹å™¨
docker rm

#æ‰§è¡Œå‘½ä»¤    
docker run yiji/centos7 /bin/echo &apos;hello world&apos;

#äº¤äº’è¿è¡Œï¼š
docker run -it yiji/centos7 /bin/bash

#æŸ¥çœ‹å®¹å™¨è¿è¡ŒçŠ¶æ€
docker ps -a

#æŸ¥çœ‹æŒ‡å®šå®¹å™¨çŠ¶æ€
docker inspect f46935242662

#æŸ¥çœ‹ç«¯å£éšå°„ï¼Œé€šè¿‡inspectç»“æœè¿‡æ»¤
docker inspect --format=&apos;{{.NetworkSettings.Ports}}&apos; 8f4a179a0647

#æŸ¥çœ‹å®¹å™¨èµ„æºå ç”¨
docker stats 92202cc1c3f0

#æŸ¥çœ‹docker deamonè¿è¡Œip
echo $DOCKER_HOST

#æ¸…ç†åå°åœæ­¢çš„å®¹å™¨
docker rm $( docker ps -a -q)

#æŸ¥çœ‹é•œåƒçš„ç¯å¢ƒå˜é‡
docker run  yiji/java8:2.0  env
</code></pre><h3 id="3-F-A-Q"><a href="#3-F-A-Q" class="headerlink" title="3. F.A.Q"></a>3. F.A.Q</h3><h4 id="3-1-dockeræ–‡ä»¶ç³»ç»Ÿ"><a href="#3-1-dockeræ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="3.1. dockeræ–‡ä»¶ç³»ç»Ÿ"></a>3.1. dockeræ–‡ä»¶ç³»ç»Ÿ</h4><p>dockeré•œåƒçš„æ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨å¤šå±‚å­˜å‚¨ï¼Œé•œåƒä¸­å…¨æ˜¯åªè¯»å±‚ï¼Œä¾¿äºåˆ†å‘å’Œå…±äº«(pullé•œåƒæ—¶ï¼Œä¼šåœ¨æœ¬åœ°æ‹‰å·²ç»å­˜åœ¨çš„å±‚)ã€‚è¿è¡Œæ—¶å»ºç«‹è¯»å†™å±‚ï¼Œå¯¹äºåº”ç”¨æ¥è¯´ï¼Œéœ€è¦æŠŠæ–‡ä»¶ç³»ç»Ÿmountåˆ°dockerä¸­(è¿™æ ·æ€§èƒ½æœ€å¥½)ï¼Œdevice mapperå¯¹æ€§èƒ½æœ‰å½±å“ã€‚</p>
<blockquote>
<blockquote>
<p>Data volumes provide the best and most predictable performance. This is because they bypass the storage driver and do not incur any of the potential overheads introduced by thin provisioning and copy-on-write. For this reason, you may want to place heavy write workloads on data volumes.</p>
</blockquote>
</blockquote>
<h4 id="3-2-å…³äºåŸºç¡€é•œåƒ"><a href="#3-2-å…³äºåŸºç¡€é•œåƒ" class="headerlink" title="3.2. å…³äºåŸºç¡€é•œåƒ"></a>3.2. å…³äºåŸºç¡€é•œåƒ</h4><p>åˆ¶ä½œåŸºç¡€é•œåƒæ—¶æƒè¡¡é•œåƒå¤§å°(è™½ç„¶å¯ä»¥åœ¨ä¸»æœºä¸Šç¼“å­˜åŸºç¡€é•œåƒï¼Œä¹Ÿéœ€è¦è€ƒè™‘é¦–æ¬¡åˆ†å‘çš„å¤§å°)ã€‚æˆ‘ä»¬æœ€å¼€å§‹ä½¿ç”¨centos7æ¥åˆ¶ä½œåŸºç¡€é•œåƒï¼Œå‘ç°é•œåƒ300å¤šMï¼Œå¦‚æœåœ¨åŠ ä¸Šjava8ï¼ŒåŸºç¡€é•œåƒæœ‰600å¤šMäº†ã€‚</p>
<p>å¯ä»¥å‚è€ƒ<a href="https://hub.docker.com/r/frolvlad/alpine-oraclejdk8/" target="_blank" rel="noopener">frolvlad/alpine-oraclejdk8</a>æ¥åˆ¶ä½œåŸºç¡€é•œåƒã€‚</p>
<pre><code>REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
yiji/java8          2.0                 1d58b31d19a0        4 days ago          166.5 MB
</code></pre><p>java8çš„åŸºç¡€é•œåƒåªæœ‰ä¸åˆ°200mã€‚</p>
<h4 id="3-3-åˆ¶ä½œdockeré•œåƒå¹¶è¿è¡Œ"><a href="#3-3-åˆ¶ä½œdockeré•œåƒå¹¶è¿è¡Œ" class="headerlink" title="3.3. åˆ¶ä½œdockeré•œåƒå¹¶è¿è¡Œ"></a>3.3. åˆ¶ä½œdockeré•œåƒå¹¶è¿è¡Œ</h4><ol>
<li><p>ç¼–å†™Dockerfile</p>
<pre><code>FROM yiji/java8:2.0
COPY  yiji-boot-test-1.1-SNAPSHOT.jar /opt/yiji-boot-test-1.1-SNAPSHOT.jar
WORKDIR /opt
ENTRYPOINT java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=4004 -jar /opt/yiji-boot-test-1.1-SNAPSHOT.jar
</code></pre></li>
<li><p>build   </p>
<pre><code>docker build -t  yiji-boot-test:1.0 .
</code></pre></li>
<li><p>run</p>
<pre><code>docker run -p 8081:8081 -p 4004:4004  yiji-boot-test:1.0
</code></pre><p> å…¶ä¸­8081æ˜¯åº”ç”¨webç«¯å£ï¼Œ4004ç«¯å£æ˜¯è¿œç¨‹è°ƒè¯•ç«¯å£</p>
</li>
<li><p>åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤</p>
<p> åœ¨å®¹å™¨è¿è¡Œèµ·æ¥åï¼Œæˆ‘ä»¬éœ€è¦å»å®¹å™¨å†…checkä¸‹æƒ…å†µã€‚</p>
<pre><code>docker exec -it 92202cc1c3f0  sh
</code></pre></li>
</ol>
<h4 id="3-4-dockeræœ¬åœ°å­˜å‚¨"><a href="#3-4-dockeræœ¬åœ°å­˜å‚¨" class="headerlink" title="3.4 dockeræœ¬åœ°å­˜å‚¨"></a>3.4 dockeræœ¬åœ°å­˜å‚¨</h4><p>docker å®¹å™¨è¿è¡Œçš„æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°ã€‚ä¸‹é¢æ¥çœ‹çœ‹è¿™äº›æ–‡ä»¶ï¼š</p>
<p>æŸ¥çœ‹docker container id</p>
<pre><code>CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                   PORTS                                            NAMES
8f4a179a0647        yiji-boot-test:1.0   &quot;/bin/sh -c &apos;java -ag&quot;   2 hours ago         Up 2 hours               0.0.0.0:4004-&gt;4004/tcp, 0.0.0.0:8081-&gt;8081/tcp   silly_northcutt
</code></pre><p>ç™»é™†åˆ°è™šæ‹Ÿæœºï¼Œåœ¨macå’Œwindowsä¸‹ï¼Œdockeråœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œ</p>
<pre><code>docker-machine ssh default
</code></pre><p>åˆ‡æ¢åˆ°dockerè¿è¡Œç›®å½•</p>
<pre><code>sudo su -
cd /var/lib/docker/aufs/mnt/
</code></pre><p><code>ls |grep 8f4a179a0647</code>å‘ç°ä¸¤ä¸ªç›®å½•</p>
<pre><code>8f4a179a064737658b4055fb785c432c843f473a9d5fc40fba445017bd5b7e2e
8f4a179a064737658b4055fb785c432c843f473a9d5fc40fba445017bd5b7e2e-init
</code></pre><p>è¿›å…¥åˆ°ç¬¬ä¸€ä¸ªç›®å½•çš„optå­ç›®å½•ä¸‹ï¼Œä¼šæ‰¾åˆ°æˆ‘ä»¬æ‰“åŒ…çš„jaræ–‡ä»¶(chrootçš„é­”åŠ›æ‰€åœ¨)</p>
<pre><code>root@default:/mnt/sda1/var/lib/docker/aufs/mnt/8f4a179a064737658b4055fb785c432c843f473a9d5fc40fba445017bd5b7e2e/opt# ls -l
total 67168
-rw-r--r--    1 root     root      68777433 Dec 28 08:26 yiji-boot-test-1.1-SNAPSHOT.jar
</code></pre><h4 id="3-5-å…³äºdockerçš„å®‰å…¨"><a href="#3-5-å…³äºdockerçš„å®‰å…¨" class="headerlink" title="3.5 å…³äºdockerçš„å®‰å…¨"></a>3.5 <a name="docker-security">å…³äºdockerçš„å®‰å…¨</a></h4><p><iframe src="//www.slideshare.net/slideshow/embed_code/key/vhMhelcV6Z9rXr" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/jpetazzo/docker-linux-containers-lxc-and-security" title="Docker, Linux Containers (LXC), and security" target="_blank">Docker, Linux Containers (LXC), and security</a> </strong> from <strong><a href="//www.slideshare.net/jpetazzo" target="_blank">JÃ©rÃ´me Petazzoni</a></strong> </div></p>
<p>æˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œ</p>
<ol>
<li><p>ä¸è¦ä½¿ç”¨root in docker</p>
<p> å‚è€ƒ<a href="http://stackoverflow.com/questions/24308760/running-app-inside-docker-as-non-root-user" target="_blank" rel="noopener">Running app inside Docker as non-root user</a></p>
</li>
<li><p>ç»å¸¸å‡çº§å†…æ ¸</p>
</li>
</ol>
<p>åšå®‰å…¨çš„åŒå­¦å¯ä»¥çœ‹çœ‹æ›´å¤šå…³äºdocker å®‰å…¨çš„æ–‡ç« :</p>
<p><a href="https://github.com/docker/docker-bench-security" target="_blank" rel="noopener">docker-bench-security</a></p>
<p><a href="https://github.com/konstruktoid/Docker/blob/master/Security/CheatSheet.md" target="_blank" rel="noopener">Security CheatSheet</a></p>
<p><a href="https://benchmarks.cisecurity.org/tools2/docker/CIS_Docker_1.6_Benchmark_v1.0.0.pdf" target="_blank" rel="noopener">CIS Docker 1.6 Benchmark</a></p>
<p>æœ€åå¼•ç”¨<a href="https://twitter.com/mortman" target="_blank" rel="noopener">David Mortman</a>åœ¨2015å¹´<a href="https://www.defcon.org/" target="_blank" rel="noopener">Defcon</a>çš„ä¸€å¥è¯ï¼š</p>
<blockquote>
<blockquote>
<p>a year ago, [docker and security] was pretty horrible,six months ago it wasnâ€™t so bad, and now itâ€™s pretty usable.</p>
</blockquote>
</blockquote>
<h4 id="3-6-docker-run-vm"><a href="#3-6-docker-run-vm" class="headerlink" title="3.6 docker run vm?"></a>3.6 docker run vm?</h4><p>ä¸€äº›è§‚ç‚¹ï¼š</p>
<p><a href="http://dockone.io/article/935" target="_blank" rel="noopener">2016å¹´å…­å¤§OpenStack &amp; Dockerå‘å±•è¶‹åŠ¿é¢„æµ‹</a></p>
<blockquote>
<blockquote>
<p>ç”±åŸæœ¬çš„è™šæ‹Ÿæœºç®¡ç†ç¨‹åºä¸ºæ ¸å¿ƒè½¬å˜ä¸ºå®¹å™¨åŠ è£¸æœºç»„åˆæ¨¡å¼</p>
</blockquote>
</blockquote>
<p><a href="http://www.infoq.com/cn/news/2015/12/hypernetes-caas" target="_blank" rel="noopener">Hyperneteså®ç°å¤šç§Ÿæˆ·CaaSï¼Œä¸”æ— éœ€å®¢æˆ·æ“ä½œç³»ç»Ÿ</a></p>
<blockquote>
<blockquote>
<p>OpenStackæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå’Œç®¡ç†äº‘çš„IaaSæ¡†æ¶ï¼ŒHypernetesä½¿ç”¨äº†å®ƒçš„éƒ¨åˆ†ç»„ä»¶ã€‚å®ƒä½¿ç”¨OpenStackçš„èº«ä»½å’ŒæœåŠ¡ç›®å½•æä¾›ç¨‹åºKeystoneè¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚å®ƒè¿˜ä½¿ç”¨äº†å…¶ä»–çš„OpenStackç»„ä»¶ï¼Œå¦‚ç”¨äºå­˜å‚¨çš„Cinderå’ŒCephï¼Œç”¨äºç½‘ç»œç®¡ç†çš„Neutronã€‚å¯¹äºOpenStackè€Œè¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„ç”¨æ³•ï¼Œå› ä¸ºå…¶ç»„ä»¶é€šå¸¸éƒ½ä¸åœ¨OpenStackéƒ¨ç½²ä¹‹å¤–ä½¿ç”¨ã€‚</p>
</blockquote>
</blockquote>
<h4 id="3-7-docker-api"><a href="#3-7-docker-api" class="headerlink" title="3.7 docker api"></a>3.7 docker api</h4><h5 id="3-7-1-unix-socket-api"><a href="#3-7-1-unix-socket-api" class="headerlink" title="3.7.1 unix-socket api"></a>3.7.1 unix-socket api</h5><p>æŸ¥çœ‹dockerä¿¡æ¯:</p>
<pre><code>curl --unix-socket /var/run/docker.sock http:/info |jq
</code></pre><p>apiæ–‡æ¡£:</p>
<pre><code>https://docs.docker.com/engine/reference/api/docker_remote_api/
</code></pre><h5 id="3-7-2-java-api"><a href="#3-7-2-java-api" class="headerlink" title="3.7.2 java api"></a>3.7.2 java api</h5><p>ä¾èµ–ï¼š</p>
<pre><code>&lt;dependency&gt;
        &lt;groupId&gt;com.github.docker-java&lt;/groupId&gt;
        &lt;artifactId&gt;docker-java&lt;/artifactId&gt;
        &lt;version&gt;3.0.1&lt;/version&gt;
        &lt;exclusions&gt;
            &lt;exclusion&gt;
                &lt;groupId&gt;de.gesellix&lt;/groupId&gt;
                &lt;artifactId&gt;unix-socket-factory&lt;/artifactId&gt;
            &lt;/exclusion&gt;
        &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.kohlschutter.junixsocket&lt;/groupId&gt;
        &lt;artifactId&gt;junixsocket-common&lt;/artifactId&gt;
        &lt;version&gt;2.0.4&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.kohlschutter.junixsocket&lt;/groupId&gt;
        &lt;artifactId&gt;junixsocket-native-common&lt;/artifactId&gt;
        &lt;version&gt;2.0.4&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre><p> ä½¿ç”¨ï¼š</p>
<pre><code> DockerClient dockerClient = DockerClientBuilder.getInstance(&quot;unix:///var/run/docker.sock&quot;).build();
Info info = dockerClient.infoCmd().exec();
System.out.print(info);
</code></pre><p>apiæ–‡æ¡£:</p>
<pre><code>https://github.com/docker-java/docker-java/
</code></pre><h4 id="3-8-docker-on-centos7é…ç½®"><a href="#3-8-docker-on-centos7é…ç½®" class="headerlink" title="3.8 docker on centos7é…ç½®"></a>3.8 docker on centos7é…ç½®</h4><p>centos7ä½¿ç”¨systemdæ¥ç®¡ç†æœåŠ¡ï¼Œdockeré…ç½®æ–‡ä»¶<code>/lib/systemd/system/docker.service</code>ã€‚æ¯”å¦‚å¢åŠ tcp apiç«¯å£ï¼Œä¿®æ”¹</p>
<pre><code>ExecStart=/usr/bin/dockerd
ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --insecure-registry catalog.shurenyun.com
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/why-react/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/why-react/" itemprop="url">Why react?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2015-12-01T21:52:17+08:00">
                2015-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æ˜¨å¤©ç»™æœ‹å‹æ¨èäº†<code>React</code>ï¼Œä½†å¿ƒé‡Œè¿˜çœŸæ²¡æœ‰åº•ï¼Œè¿™é‡Œæ•´ç†ä¸‹èµ„æ–™ï¼Œå¦‚æœä¸è€ƒè™‘æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ï¼Œè¿™ä¸œä¸œçœŸä¸é”™ğŸ˜„ã€‚</p>
<h4 id="1-è™šæ‹Ÿdomæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-è™šæ‹Ÿdomæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. è™šæ‹Ÿdomæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. è™šæ‹Ÿdomæ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>è™šæ‹ŸDOMæ˜¯HTML DOMçš„æŠ½è±¡ï¼Œå®ƒå’Œæµè§ˆå™¨çš„å®ç°åˆ†ç¦»ã€‚</p>
<h4 id="2-ä¸ºä»€ä¹ˆè™šæ‹Ÿdomå¿«ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆè™šæ‹Ÿdomå¿«ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆè™šæ‹Ÿdomå¿«ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆè™šæ‹Ÿdomå¿«ï¼Ÿ</h4><p>DOMæ‹–æ…¢JavaScriptã€‚æ‰€æœ‰çš„DOMæ“ä½œéƒ½æ˜¯åŒæ­¥çš„ï¼Œä¼šå µå¡æµè§ˆå™¨ã€‚JavaScriptæ“ä½œDOMæ—¶ï¼Œå¿…é¡»ç­‰å‰ä¸€ä¸ªæ“ä½œç»“æŸï¼Œæ‰èƒ½æ‰§è¡Œåä¸€ä¸ªæ“ä½œã€‚åªè¦ä¸€ä¸ªæ“ä½œæœ‰å¡é¡¿ï¼Œæ•´ä¸ªç½‘é¡µå°±ä¼šçŸ­æš‚å¤±å»å“åº”ã€‚æµè§ˆå™¨é‡ç»˜ç½‘é¡µçš„é¢‘ç‡æ˜¯60FPSï¼ˆå³16æ¯«ç§’/å¸§ï¼‰ï¼ŒJavaScriptåšä¸åˆ°åœ¨16æ¯«ç§’å†…å®ŒæˆDOMæ“ä½œï¼Œå› æ­¤äº§ç”Ÿäº†è·³å¸§ã€‚è™šæ‹Ÿdomçš„æ”¹å˜å¹¶ä¸ä¼šå¼•èµ·æµè§ˆå™¨domçš„æ”¹å˜ï¼Œè€Œæ˜¯ç”±Reactåœ¨åˆé€‚çš„æ—¶æœºæ¯”è¾ƒå·®å¼‚å¹¶æ¸²æŸ“ï¼Œä¿è¯<code>FPS</code>ã€‚</p>
<h4 id="3-Why-is-Reactâ€™s-concept-of-Virtual-DOM-said-to-be-more-performant-than-dirty-model-checking"><a href="#3-Why-is-Reactâ€™s-concept-of-Virtual-DOM-said-to-be-more-performant-than-dirty-model-checking" class="headerlink" title="3. Why is Reactâ€™s concept of Virtual DOM said to be more performant than dirty model checking?"></a>3. Why is Reactâ€™s concept of Virtual DOM said to be more performant than dirty model checking?</h4><p>React knows when to re-render the scene because it is able to <strong>observe when this data changes</strong>. Dirty checking is slower than observables because you must poll the data at a regular interval and check all of the values in the data structure recursively. By comparison, setting a value on the state will signal to a listener that some state has changed, so React can simply listen for change events on the state and queue up re-rendering.(è¿™ç‚¹éšç€es6çš„<code>Proxy</code>åˆ°æ¥ï¼Œ<code>AngularJS</code>ä¼šè¶Šæ¥è¶Šå¼ºå¤§ğŸ˜„)</p>
<h4 id="4-What-makes-React-fast"><a href="#4-What-makes-React-fast" class="headerlink" title="4. What makes React fast ?"></a>4. What makes React fast ?</h4><ul>
<li>Batched DOM read/write operations.</li>
<li>Efficient update of sub-tree only.</li>
</ul>
<p>Compared to dirty-check, the key differences IMO are:</p>
<p>Model dirty-checking: React component is explicitly set as dirty whenever setState is called, so thereâ€™s no comparison (of the data) needed here. For dirty-checking, the comparison (of the models) always happen each digest loop.</p>
<p>DOM updating: DOM operations are very expensive because modifying the DOM will also apply and calculate CSS styles, layouts. The saved time from unnecessary DOM modification can be longer than the time spent diffing the virtual DOM.</p>
<h4 id="4-Whatâ€™s-the-problem-of-template-engineï¼Ÿ"><a href="#4-Whatâ€™s-the-problem-of-template-engineï¼Ÿ" class="headerlink" title="4. Whatâ€™s the problem of template engineï¼Ÿ"></a>4. Whatâ€™s the problem of template engineï¼Ÿ</h4><p>Template languages express the initial render of your application, and youâ€™re responsible for manually mutating the state of the UI when your backing data changes and events occur.</p>
<h4 id="5-how-to-run"><a href="#5-how-to-run" class="headerlink" title="5. how to run ?"></a>5. how to run ?</h4><p><img src="/why-react/reactjs.png" alt=""></p>
<p>ä¸Šé¢éƒ¨åˆ†æ˜¯ç”¨æˆ·è§¦å‘çš„ï¼Œä¸‹é¢éƒ¨åˆ†æ˜¯å®šæ—¶è§¦å‘çš„ã€‚</p>
<p>é¦–å…ˆè¯´ä¸Šé¢éƒ¨åˆ†ï¼š</p>
<ol>
<li>ç”¨æˆ·ç‚¹å‡»æŸdom</li>
<li><p><code>top-level event handler</code>åˆ†å‘äº‹ä»¶åˆ°æŒ‡å®šçš„<code>event handler</code></p>
<p> <code>top-level event handler</code>æŒ‡çš„æ˜¯<code>document</code>ä¸Šçš„<code>event handler</code>,è¿™ç§æ–¹å¼èƒ½å¤Ÿæé«˜æ€§èƒ½(å› ä¸ºåœ¨æ¯ä¸ªçœŸå®çš„domä¸Šé¢ç»‘å®šäº‹ä»¶æ˜¯éå¸¸æ…¢çš„)å¹¶ä¸”è·¨æµè§ˆå™¨(æµè§ˆå™¨ä¸­çš„äº‹ä»¶æœ¬èº«å°±æ²¡æœ‰ç»Ÿä¸€)</p>
</li>
<li><p>ç”¨æˆ·ä»£ç è°ƒç”¨setState()</p>
<p> <code>AngularJS</code>åŒå‘ç»‘å®šï¼Œä¸éœ€è¦ç”¨æˆ·è°ƒç”¨çŠ¶æ€å˜æ›´ã€‚æ‰€ä»¥ï¼Œå¿…é¡»è¦å»åšå¤§é‡çš„<code>dirty check</code>ã€‚è™½ç„¶æ˜¯ä¸€ç§å€’é€€ï¼Œä½†æ˜¯ä¸ºäº†æ€§èƒ½å¿äº†ï¼Œç­‰ES6å§ã€‚</p>
</li>
</ol>
<p>ä¸‹é¢éƒ¨åˆ†çš„é€»è¾‘ï¼š<code>event loop</code>å‘¨æœŸæ€§çš„æ£€æŸ¥æœ‰çŠ¶æ€ç»„ä»¶æ˜¯å¦<code>dirty</code>ï¼Œç„¶åé€šè¿‡<code>diff</code>ç®—æ³•æ‰¹é‡æ›´æ–°æµè§ˆå™¨domæ ‘ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/be-happy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/be-happy/" itemprop="url">don't worry, be happy!</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2015-11-22T21:52:17+08:00">
                2015-11-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="æƒ…ç»ªåœ°é›·åŒºé¿é›·æ–¹æ¡ˆï¼š"><a href="#æƒ…ç»ªåœ°é›·åŒºé¿é›·æ–¹æ¡ˆï¼š" class="headerlink" title="æƒ…ç»ªåœ°é›·åŒºé¿é›·æ–¹æ¡ˆï¼š"></a>æƒ…ç»ªåœ°é›·åŒºé¿é›·æ–¹æ¡ˆï¼š</h3><ol>
<li>å®‰æ’Bè®¡åˆ’ (æ¯”å¦‚ç­‰äººåƒé¥­ï¼Œæå‰å‡†å¤‡ç‚¹äº‹åšï¼Œåˆ«äººæ²¡åˆ°å°±åšè‡ªå·±çš„äº‹)</li>
<li>å…¬å¼€è‡ªå·±çš„æƒ…ç»ªæ­»ç©´ (æ¯”å¦‚æå‰ç»™äººè¯´å“ªäº›æ˜¯ä¸å–œæ¬¢çš„ï¼Œå¦‚æœä½ è¿™æ ·åšäº†ï¼Œæˆ‘ä¹Ÿé¿å…ä¸äº†æˆ‘ä¸å‘è„¾æ°”)</li>
</ol>
<h3 id="æƒ…ç»ªç®¡ç†åœ¨ç”Ÿæ´»ä¸å·¥ä½œä¸­çš„åº”ç”¨"><a href="#æƒ…ç»ªç®¡ç†åœ¨ç”Ÿæ´»ä¸å·¥ä½œä¸­çš„åº”ç”¨" class="headerlink" title="æƒ…ç»ªç®¡ç†åœ¨ç”Ÿæ´»ä¸å·¥ä½œä¸­çš„åº”ç”¨"></a>æƒ…ç»ªç®¡ç†åœ¨ç”Ÿæ´»ä¸å·¥ä½œä¸­çš„åº”ç”¨</h3><ol>
<li><p>æ­£å‘æ€è€ƒ</p>
<p> å‡¡äº‹å¾€æ­£é¢çš„è§’åº¦å»æƒ³ï¼Œé€‰å–å¯¹è‡ªå·±æœ€æœ‰åˆ©çš„æ³¨è§£</p>
</li>
<li><p>è½¬ç§»æ³¨æ„åŠ›</p>
<p> å»åšèƒ½å¸¦æ¥å¥½æƒ…ç»ªçš„æ´»åŠ¨æˆ–äº‹æƒ…ã€‚æ¯”å¦‚åƒè‡ªå·±æœ€å–œçˆ±çš„é£Ÿç‰©</p>
</li>
<li><p>è®©å¼€æ”¾çš„è‚¢ä½“åŠ¨ä½œå¸¦åŠ¨æƒ…ç»ª</p>
<p> æ¯”å¦‚å»çˆ¬å±±ï¼Œå»è·‘æ­¥ï¼Œå»æ—…æ¸¸ã€‚</p>
</li>
<li><p>é€è¿‡é—®å¥å¼•å¯¼è‡ªå·±æ”¹å˜è®¤çŸ¥</p>
<pre><code>a.å¯¹æ–¹æ˜¯æ•…æ„çš„è¿˜æ˜¯æ— å¿ƒçš„ï¼Ÿ
b.è¿™ä»¶äº‹è¿˜æœ‰æ²¡æœ‰å…¶ä»–è§’åº¦ä¸æ„ä¹‰å¯ä»¥è®©æˆ‘æ„Ÿè§‰æ›´å¥½ï¼Ÿ
c.å¦‚æœæˆ‘å¸Œæœ›è‡ªå·±çš„æƒ…ç»ªå˜å¥½ï¼Œç°åœ¨æˆ‘åº”è¯¥åšä»€ä¹ˆï¼Ÿ
d.è¿™æ ·åšæ˜¯çœŸçš„ä¼šè®©æƒ…ç»ªå˜å¥½è¿˜æ˜¯ä¼šæœ‰åé—ç—‡ï¼Ÿ
e.æˆ‘å¯ä»¥å¯»æ±‚è°çš„å¸®åŠ©æ¥æ”¹å–„è‡ªå·±çš„æƒ…ç»ªï¼Ÿ
</code></pre></li>
</ol>
<ol>
<li>å‘ç°è‡ªå·±æƒ…ç»ªæœ‰å¤±æ§çš„æ„Ÿè§‰æˆ–å€¾å‘ï¼Œå¿…è¦æ—¶ç¦»å¼€ç°åœº</li>
<li>æŠŠä¸æ»¡ã€æ„¤æ€’ã€å¤±æ„ç­‰è´Ÿé¢æƒ…ç»ªå†™åœ¨çº¸ä¸Šï¼Œç„¶åçƒ§æ‰ã€å†²æ‰ã€å¯„å‡ºæˆ–è€…æ”¶è—</li>
<li>äº†è§£è‡ªèº«çš„æœ‰ç‚¹ï¼Œç§¯æè¡¨ç°è‡ªå·±ï¼Œä½†æ±‚å°½å¿ƒå°½åŠ›</li>
<li>å¤šçœ‹åˆ«äººçš„å¥½ï¼Œé€‚åº¦äºˆä»¥å®½å®¹çš„å¯¹å¾…</li>
<li><p>æ¥è¿‘æ‹¥æœ‰å¿ƒçµæ™ºæ…§çš„è‰¯å¸ˆç›Šå‹</p>
<p> æ™ºæ…§ä¸èµ·çƒ¦æ¼ï¼Œæ…ˆæ‚²æ²¡æœ‰æ•Œäºº</p>
</li>
<li><p>æé†’è‡ªå·±ï¼šä¸–é—´äº‹éƒ½åªæ˜¯è¿‡ç¨‹è€Œéç»“æœ</p>
<p>æ¯ä»¶äº‹æœ€ç»ˆéƒ½ä¼šè¿‡å»ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±(å‡¡äººå¿…æœ‰ä¸€æ­»)</p>
</li>
<li><p>å…¨åŠ›ä»¥èµ´åï¼Œæ”¾ä¸‹å¾—å¤±å¿ƒï¼Œå› ä¸ºä½ æ²¡æœ‰åŠæ³•å†³å®šæ‰€æœ‰çš„äº‹ä¸€å®šå¦‚ä½ æ‰€æ„¿</p>
<p>æˆ˜èƒœå¯¹æ‰‹åªæ˜¯äººç”Ÿçš„èµ¢å®¶ï¼Œæˆ˜èƒœè‡ªå·±æ‰æ˜¯å‘½è¿çš„å¼ºè€…</p>
</li>
</ol>
<h3 id="å“ˆä½›å¤§å­¦æ¨è20ä¸ªå¿«ä¹çš„ä¹ æƒ¯"><a href="#å“ˆä½›å¤§å­¦æ¨è20ä¸ªå¿«ä¹çš„ä¹ æƒ¯" class="headerlink" title="å“ˆä½›å¤§å­¦æ¨è20ä¸ªå¿«ä¹çš„ä¹ æƒ¯"></a>å“ˆä½›å¤§å­¦æ¨è20ä¸ªå¿«ä¹çš„ä¹ æƒ¯</h3><ol>
<li><p>be grateful    (å­¦ä¼šæ„Ÿæ©)</p>
<p> è®©è‡ªå·±å˜æ…¢è„šæ­¥ï¼Œçœ‹çœ‹ä½ çš„å››å‘¨ï¼Œå…³æ³¨ç”Ÿæ´»ä¸­çš„ç»†å¾®ä¹‹å¤„ï¼šäººè¡Œé“ä¸Šæ·¡ç´«è‰²çš„èŠ±ï¼Œç¾ä¸½çš„æ—¥è½ï¼Œæ´—å»ä½ ä¸€å¤©ç–²æƒ«çš„æ·‹æµ´ï¼Œä¼´ä¾£çœ¼ä¸­çš„ç¬‘å®¹ã€‚å½“ä½ çš„æ„Ÿæ©ä¹‹å¿ƒèƒ½å¤Ÿæ¬£èµç”Ÿæ´»çš„ç¾ï¼Œæ€è€ƒå’Œç¥ç¦ï¼Œä½ è‡ªç„¶å°±å……æ»¡äº†å¹¸ç¦æ„Ÿã€‚</p>
</li>
<li><p>choose your friedns wisely</p>
<p> å¦‚æœä½ æƒ³å˜å¾—å¼€å¿ƒçš„è¯ï¼Œè¦é€‰æ‹©å’Œä¹è§‚çš„æœ‹å‹åœ¨ä¸€èµ·ï¼Œä»–ä»¬èƒ½æ¬£èµä½ çœŸå®çš„è‡ªå·±ï¼Œè®©ä½ çš„ç”Ÿæ´»å˜å¾—æ›´ä¸°å¯Œï¼Œå¿«ä¹ï¼Œæœ‰æ„ä¹‰ã€‚</p>
</li>
<li><p>cultivate compassion (åŸ¹å…»åŒæƒ…å¿ƒ)</p>
<p> å½“æˆ‘ä»¬ä»£æ›¿åˆ«äººï¼Œç«™åœ¨å¦ä¸€ä¸ªè§’åº¦çœ‹é—®é¢˜ï¼Œæˆ‘ä»¬æ›´èƒ½ç”¨åŒæƒ…å¿ƒï¼Œå®¢è§‚å’Œæœ‰æ•ˆçš„å¤„ç†é—®é¢˜ã€‚ç”Ÿæ´»ä¸­å°±ä¼šå°‘ä¸€äº›å†²çªï¼Œå¤šä¸€ç‚¹å¿«ä¹ã€‚</p>
</li>
<li><p>keep leaning</p>
<p> å­¦ä¹ è®©æˆ‘ä»¬ä¿æŒå¹´è½»ï¼Œæ¢¦æƒ³è®©æˆ‘ä»¬å……æ»¡æ´»åŠ›ã€‚æˆ‘ä»¬è¿ç”¨å¤§è„‘ï¼Œè¿›è¡Œè¿ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¸å¤§ä¼šæƒ³ä¸å¼€å¿ƒå¿ƒçš„äº‹æƒ…ï¼Œæˆ‘ä»¬ä¼šå˜å¾—æ›´å¼€å¿ƒå’Œæ»¡è¶³ã€‚</p>
</li>
<li><p>become a problem solver (å­¦ä¼šè§£å†³é—®é¢˜)</p>
</li>
<li>do what you love</li>
<li><p>live in the present</p>
<p> ä½ æ„Ÿåˆ°æ²®ä¸§ï¼Œæ˜¯å› ä¸ºä½ æ´»åœ¨è¿‡å»ã€‚ä½ ä¼šæ„Ÿåˆ°æ‹…å¿§å’Œç„¦è™‘ï¼Œæ˜¯å› ä¸ºä½ æ´»åœ¨æœªæ¥ã€‚ä½†æ˜¯å½“ä½ æ„Ÿåˆ°æ»¡è¶³ï¼Œå¼€å¿ƒå’Œå¹³å’Œæ—¶ï¼Œä½ æ‰æ˜¯æ´»åœ¨å½“ä¸‹ã€‚</p>
</li>
<li><p>laugh often</p>
<p> ã€€ç¬‘æ˜¯å¯¹æŠ—ç”Ÿæ°”æˆ–æ²®ä¸§æœ€æœ‰åŠ›çš„çš„ä¸œè¥¿ã€‚ä¸è¦æŠŠç”Ÿæ´»çœ‹çš„å¤ªä¸¥è‚ƒã€‚è¦å­¦ä¼šåœ¨æ¯æ—¥çš„å¥‹æ–—ä¸­å¯»æ‰¾å¹½é»˜æ„Ÿå’Œç¬‘å£°ã€‚
 ã€€</p>
</li>
<li><p>practice forgiveness</p>
<p> æ†æ¨å’Œç”Ÿæ°”æ˜¯å¯¹è‡ªæˆ‘çš„æƒ©ç½šã€‚å½“ä½ é‡Šæ€€çš„æ—¶å€™ï¼Œäº‹å®ä¸Šä½ æ˜¯åœ¨å¯¹è‡ªå·±æ–½ä»¥å–„æ„ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå­¦ä¼šåŸè°…è‡ªå·±ã€‚æ¯ä¸ªäººéƒ½çŠ¯é”™ã€‚åªæœ‰é€šè¿‡æˆ‘ä»¬çš„é”™è¯¯ï¼Œæˆ‘ä»¬æ‰æ…¢æ…¢å­¦ä¼šå¦‚ä½•æˆä¸ºä¸€ä¸ªæ›´å¼ºå¤§ï¼Œæ›´å¥½çš„äººã€‚</p>
</li>
<li><p>say thanks often</p>
<p>å¯¹ç”Ÿæ´»ä¸­çš„ç¥ç¦è¦å­¦ä¼šæ¬£èµã€‚å‘é‚£äº›è®©ä½ ç”Ÿæ´»å˜å¥½çš„äººï¼Œæ— è®ºæˆ–å¤§æˆ–å°ï¼Œè¡¨è¾¾å‡ºä½ çš„æ¬£èµä¹‹æƒ…ä¹ŸåŒæ ·é‡è¦ã€‚</p>
</li>
<li><p>create deeper connections ï¼ˆå­¦ä¼šæ·±äº¤ï¼‰</p>
<p>æˆ‘ä»¬çš„å¹¸ç¦æ„Ÿä¼šåœ¨å’Œå¦ä¸€ä¸ªäººçš„æ·±äº¤ä¸­ä¸æ–­çŒ›å¢ã€‚ä¸“æ³¨è†å¬æ˜¯åŠ å¼ºè¿™ç§å…³ç³»çº½å¸¦å’ŒæŠŠå¹¸ç¦æ„Ÿå¸¦ç»™è‡ªå·±å’Œåˆ«äººçš„ä¸¤ä¸ªæœ€é‡è¦çš„æ–¹é¢ã€‚</p>
</li>
<li><p>keep you agreement</p>
<p>æˆ‘ä»¬çš„è‡ªå°Šæ˜¯å»ºç«‹åœ¨æˆ‘ä»¬å¯¹è‡ªå·±å®ˆæ‰¿è¯ºçš„æƒ…å†µä¸‹ã€‚é«˜åº¦çš„è‡ªå°Šå’Œå¹¸ç¦æ„Ÿæœ‰ç›´æ¥å…³è”ã€‚æ‰€ä»¥è¦å¯¹è‡ªå·±å’Œåˆ«äººéµå®ˆæ‰¿è¯ºã€‚</p>
</li>
<li><p>meditate ï¼ˆå†¥æƒ³ï¼‰</p>
</li>
<li><p>focus on what youâ€™re doing</p>
<p>å½“ä½ å…¨èº«å¿ƒæŠ•å…¥ä¸€ä»¶äº‹çš„æ—¶å€™ï¼Œä½ å°±ä¼šå¤„äºä¸€ä¸ªå¼€å¿ƒçš„çŠ¶æ€ã€‚å½“æˆ‘ä»¬å¤„äºè¿™ç§çŠ¶æ€ï¼Œä½ å°±ä¸å¤§ä¼šå…³å¿ƒåˆ«äººå¯¹ä½ æ€ä¹ˆçœ‹ï¼Œä¸å¤§ä¼šè¢«ä¸å¤§é‡è¦çš„äº‹æƒ…å¹²æ‰°ã€‚ç»“æœå‘¢ï¼Ÿæ›´å¹¸ç¦ï¼Œå½“ç„¶å•¦ï¼</p>
</li>
<li><p>be optimistic</p>
<p>å¯¹äºå¼€å¿ƒçš„äººæ¥è¯´ï¼Œç»ç’ƒéƒ½ä¸€ç›´æ˜¯åŠæ»¡çš„ã€‚æ¯å½“ä½ é¢å¯¹ä¸€ä¸ªæŒ‘æˆ˜æ—¶ï¼Œå¦‚æœä½ å€¾å‘äºæƒ³è±¡æœ€åçš„æƒ³æ³•ï¼Œé‚£å°±è‡ªæˆ‘è½¬æ¢è¿™ç§æƒ…å†µã€‚å‘Šè¯‰ä½ è‡ªå·±ä¸€ä¸ªçŠ¶å†µä¸­çš„å¥½å¤„æˆ–è€…ä½ ä»ä¸­å­¦åˆ°çš„ä¸œè¥¿ã€‚ä¹è§‚è‚¯å®šèƒ½é©±åŠ¨æˆåŠŸå’Œå¹¸ç¦æ„Ÿã€‚</p>
</li>
<li><p>love unconditionally</p>
<p>æ²¡äººæ˜¯å®Œç¾çš„,æ¥å—ä½ è‡ªå·±æ‰€æœ‰çš„ä¸å®Œç¾,ä¹Ÿè¦è¿™æ ·å¯¹å¾…åˆ«äººã€‚æ— æ¡ä»¶çš„çˆ±ä¸€ä¸ªäººå¹¶ä¸æ„å‘³ç€ä½ è¦èŠ±æ‰€æœ‰çš„æ—¶é—´å’Œä»–ä»¬åœ¨ä¸€èµ·ï¼Œæˆ–è€…å¸®åŠ©ä»–ä»¬è§£å†³é—®é¢˜ã€‚æ— æ¡ä»¶çš„çˆ±æ„å‘³ç€æ¥å—çœŸå®çš„ä»–ä»¬ï¼Œä»¥ä»–ä»¬è‡ªå·±çš„æ­¥ä¼ï¼Œè®©ä»–ä»¬è‡ªå·±æ‘¸ç´¢ã€‚</p>
</li>
<li><p>donâ€™t give up</p>
<p>æ²¡æœ‰å®Œæˆçš„æ–¹æ¡ˆå’Œä¸æ–­çš„å¤±è´¥ä¸å¯é¿å…çš„ä¼šå‰Šå¼±ä½ çš„è‡ªå°Šã€‚å¦‚æœä½ å†³å®šåšæŸäº‹ï¼Œåšå®Œå®ƒã€‚</p>
</li>
<li><p>do you best and then let go</p>
<p>æ¯ä¸ªäººéƒ½æœ‰å±€é™æ€§ã€‚è€Œä¸”æœ‰æ—¶å€™å°½ç®¡æˆ‘ä»¬å¾ˆåŠªåŠ›åšä¸€ä»¶äº‹æƒ…ï¼Œä½†æ˜¯æ€»ä¼šäº‹ä¸æ„¿è¿ã€‚æ‰€ä»¥åšæœ€å¥½çš„è‡ªå·±ï¼Œç„¶åæ”¾æ‰‹ã€‚å½“ä½ å°½äº†å…¨åŠ›ï¼Œä½ å°±æ²¡æœ‰é—æ†¾äº†ã€‚</p>
</li>
<li><p>take care of yourself</p>
<p>ä¸€ä¸ªå¥åº·çš„èº«ä½“æ˜¯å¹¸ç¦çš„å…³é”®ã€‚å¦‚æœä½ èº«ä½“ä¸å¥½ï¼Œä½ æ— è®ºå¦‚ä½•åŠªåŠ›ï¼Œéƒ½å¾ˆéš¾å¿«ä¹ã€‚ç¡®ä¿¡è‡ªå·±åƒå¾—å¥½ï¼Œåšé”»ç‚¼ï¼Œæ‰¾ç‚¹æ—¶é—´ä¼‘æ¯ã€‚å¥½å¥½ç…§é¡¾ä½ çš„èº«ä½“ï¼Œå¤§è„‘å’Œç²¾ç¥ã€‚</p>
</li>
<li><p>give back ï¼ˆå­¦ä¼šç»™äºˆï¼‰</p>
<p>åšå¥½äº‹æ˜¯æœ€èƒ½ç¡®ä¿ä½ å¿ƒæƒ…å¥½çš„æ–¹æ³•ä¹‹ä¸€ã€‚æ ¹æ®å“ˆä½›ï¼Œäººä»¬åšå¥½äº‹ï¼Œä»–ä»¬çš„å¤§è„‘å˜å¾—æ´»è·ƒï¼Œå°±å¥½åƒå½“ä½ ç»å†åˆ«çš„å¥–åŠ±æ—¶ï¼Œå¤§è„‘æ‰€å—çš„åˆºæ¿€ã€‚æ‰€ä»¥ï¼Œé‚£äº›å…³å¿ƒåˆ«äººçš„äººè¦æ¯”ä¸å¤§å…³å¿ƒåˆ«äººçš„äººæ›´å¼€å¿ƒã€‚</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2015-11-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015-11-reading-notes/" itemprop="url">2015å¹´11æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2015-11-01T21:52:17+08:00">
                2015-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Next-Generation-Session-Management-with-Spring-Session"><a href="#Next-Generation-Session-Management-with-Spring-Session" class="headerlink" title="Next Generation Session Management with Spring Session"></a><a name="spring-session">Next Generation Session Management with Spring Session</a></h2><p><a href="http://www.infoq.com/articles/Next-Generation-Session-Management-with-Spring-Session" target="_blank" rel="noopener">http://www.infoq.com/articles/Next-Generation-Session-Management-with-Spring-Session</a></p>
<p>åœ¨å¤§è§„æ¨¡é›†ç¾¤çš„åœºæ™¯ï¼Œæ— çŠ¶æ€çš„åº”ç”¨èƒ½å‡å°‘è¿ç»´æˆæœ¬ã€ç¼©çŸ­åº”ç”¨æ¢å¤æ—¶é—´ã€‚spring sessionä¸»è¦è§£å†³äº†webåº”ç”¨sessionæŒä¹…åŒ–çš„é—®é¢˜ã€‚æŠŠsessionå­˜å‚¨åœ¨åº”ç”¨å¤–éƒ¨ï¼Œè®©åº”ç”¨æ— çŠ¶æ€ã€‚</p>
<p>spring sessionä¸»è¦æä¾›å¦‚ä¸‹èƒ½åŠ›ï¼š</p>
<ol>
<li>æŠŠsessionçš„å­˜å‚¨é€»è¾‘æŠ½å–å‡ºæ¥ï¼Œå¯ä»¥é€‰æ‹©rdisï¼Œæˆ–è€…è‡ªå·±å®ç°sessionå­˜å‚¨</li>
<li>ä½¿ç”¨websocketä¹Ÿèƒ½ä¿æŒä¼šè¯</li>
<li>éwebåº”ç”¨ä¹Ÿèƒ½ä½¿ç”¨ä¼šè¯</li>
<li>æ”¯æŒå¤šä¸ªsession(å¯ä»¥ç™»é™†å¤šä¸ªç”¨æˆ·)</li>
<li>Restful APIä¹Ÿèƒ½é€šè¿‡http headerç»´æŠ¤ä¼šè¯</li>
</ol>
<p>spring session 1.1ç‰ˆæœ¬æ”¯æŒ<code>HttpSessionListener</code>.å¦‚æœä½¿ç”¨çš„redisï¼Œspring sessioné€šè¿‡keyè¿‡æœŸæ—¶çš„è¿‡æœŸäº‹ä»¶+redisæ¶ˆæ¯æ¨é€æ¥å®ç°ã€‚å¯æƒœæˆ‘ä»¬ç”¨çš„æ˜¯<code>codis</code>ï¼Œæˆ‘ä»¬å®ç°äº†<code>DisabledRedisMessageListenerContainer</code>æŠŠè¿™ä¸ªèƒ½åŠ›å±è”½äº†ã€‚</p>
<p>æ›´å¤šå‚è€ƒï¼š<a href="http://docs.spring.io/spring-session/docs/current-SNAPSHOT/reference/html5/#introduction" target="_blank" rel="noopener">spring session å®˜æ–¹æ–‡æ¡£</a> <a href="https://github.com/spring-projects/spring-session/issues/4" target="_blank" rel="noopener">Add HttpSessionListener Support</a></p>
<h2 id="The-Twelve-Factor-App"><a href="#The-Twelve-Factor-App" class="headerlink" title="The Twelve-Factor App"></a><a name="the-twelve-factor-app">The Twelve-Factor App</a></h2><p><a href="http://12factor.net" target="_blank" rel="noopener">http://12factor.net</a></p>
<p>The twelve-factor app is a methodology for building software-as-a-service apps.</p>
<ol>
<li><p>Codebase:One codebase tracked in revision control, many deploys</p>
<p> one codebase per appï¼ˆall tracked in revision controlï¼‰, but there will be many deploys of the app(one or more staging use same code,use multi config file or configuration management system for different stage ). </p>
</li>
<li><p>Dependencies:Explicitly declare and isolate dependencies</p>
<p>  declares all dependencies via a dependency declaration manifest,and use dependencies check strategy to ensure that no implicit dependencies.</p>
</li>
<li><p>Config:Store config in the environment</p>
<p> use mutli config file ï¼ˆ<a href="http://bohr.me/env-aware/">build env-awared app</a>ï¼‰     or use configuration management system ï¼ˆ<a href="http://cloud.spring.io/spring-cloud-config/" target="_blank" rel="noopener">spring cloud config</a>ï¼‰</p>
</li>
<li><p>Backing Services:Treat backing services as attached resources</p>
<p> app makes no distinction between local and third party servicesï¼ˆboth are attached resourcesï¼‰. A deploy should be able to swap out a local MySQL database with one managed by a third party (such as Amazon RDS) without any changes to the appâ€™s code. </p>
</li>
<li><p>Build, release, run:Strictly separate build and run stages</p>
<p> app uses strict separation between the build, release, and run stages. For example, it is impossible to make changes to the code at runtime, since there is no way to propagate those changes back to the build stageï¼ˆwe can put dynamic part code into db ï¼‰.</p>
</li>
<li><p>Processes:Execute the app as one or more stateless processes</p>
<p> Twelve-factor processes are stateless and share-nothing. Any data that needs to persist must be stored in a stateful backing service, typically a database.Sticky sessions should never be used or relied upon. </p>
</li>
<li><p>Port binding:Export services via port binding</p>
<p> The twelve-factor app is completely self-contained and does not rely on runtime injection of a webserver into the execution environment to create a web-facing service. The web app exports HTTP as a service by binding to a port, and listening to requests coming in on that port.</p>
</li>
<li><p>Concurrency:Scale out via the process model</p>
<p>processes are a first class citizen.Processes in the twelve-factor app take strong cues from the unix process model for running service daemons. Using this model, the developer can architect their app to handle diverse workloads by assigning each type of work to a process type.</p>
</li>
<li><p>Disposability:Maximize robustness with fast startup and graceful shutdown</p>
<p> Processes should strive to minimize startup time.</p>
<p> Processes shut down gracefully ï¼ˆ ceasing to listen on the service port,thereby refusing any new requests, allowing any current requests to finish, and then exiting.ï¼‰when they receive a SIGTERM signal from the process manager.</p>
<p> For a worker process, graceful shutdown is achieved by <strong>returning the current job to the work queue</strong>.Implicit in this model is that all jobs are <strong>reentrant</strong>, which typically is achieved by wrapping the results in a transaction, or making the operation <code>idempotent</code>.</p>
<p> Processes should also be robust against sudden death, in the case of a failure in the underlying hardware.  A recommended approach is use of a robust queueing backend that returns jobs to the queue when clients disconnect or time out. Either way, a twelve-factor app is architected to handle unexpected, non-graceful terminations. </p>
</li>
<li><p>Dev/prod parity:Keep development, staging, and production as similar as possible</p>
</li>
</ol>
<pre><code>  x      | Traditional app           | Twelve-factor app     |
--------------------|------------------|-----------------------|
Time between deploys | Weeks   | Hours   |
Code authors vs code deployers  | Different people | Same people  |
Dev vs production environments  | Divergent | As similar as possible  |

The twelve-factor developer resists the urge to use different backing services between development and production, even when adapters theoretically abstract away any differences in backing services.
</code></pre><ol>
<li><p>Logs:Treat logs as event streams</p>
<p>A twelve-factor app never concerns itself with routing or storage of its output stream(maybe dont fit for java app).</p>
</li>
<li><p>Admin processes:Run admin/management tasks as one-off processes</p>
<p>One-off admin processes should be run in an identical environment as the regular long-running processes of the app. They run against a release, using the same codebase and config as any process run against that release. Admin code must ship with application code to avoid synchronization issues.</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bohr.me/2015-05-reading-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qiubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qiubo's life">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015-05-reading-notes/" itemprop="url">2015å¹´05æœˆReading Notes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2015-05-01T21:52:17+08:00">
                2015-05-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ä½¿ç”¨spring-loadedæé«˜å¼€å‘æ•ˆç‡"><a href="#ä½¿ç”¨spring-loadedæé«˜å¼€å‘æ•ˆç‡" class="headerlink" title="ä½¿ç”¨spring loadedæé«˜å¼€å‘æ•ˆç‡"></a><a name="springloaded">ä½¿ç”¨spring loadedæé«˜å¼€å‘æ•ˆç‡</a></h2><p><a href="https://github.com/spring-projects/spring-loaded" target="_blank" rel="noopener">spring-loaded</a>å’Œ<a href="http://zeroturnaround.com/software/jrebel/" target="_blank" rel="noopener">jrebel</a>ç±»ä¼¼ï¼Œå®ƒèƒ½å‘ç°æ‚¨ä¿®æ”¹çš„ç±»å¹¶é‡æ–°åŠ è½½ã€‚åœ¨å¼€å‘æµ‹è¯•æ—¶ï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨å®ƒå¯åŠ¨åï¼Œå°±å¯ä»¥ä¸€ç›´å†™ä»£ç äº†ã€‚jrebelæ˜¯æ”¶è´¹çš„è½¯ä»¶ï¼Œspring-loadedå…è´¹ï¼Œè€Œä¸”ä»–å¾ˆäº†è§£æ‚¨ä»£ç ä¸­ç”¨åˆ°çš„springç‰¹æ€§ï¼Œèƒ½å¾ˆæ™ºèƒ½çš„å¸®å¿™é‡æ–°åŠ è½½ç±»ï¼Œå¹¶æŠŠbeanæ³¨å†Œåˆ°springå®¹å™¨ä¸­ã€‚</p>
<p>ä½¿ç”¨å¾ˆç®€å•ï¼Œå‚è€ƒä¸‹é¢çš„æ­¥éª¤ï¼š</p>
<ol>
<li>ä¸‹è½½<a href="http://repo.spring.io/simple/libs-release-local/org/springframework/springloaded/1.2.3.RELEASE/springloaded-1.2.3.RELEASE.jar" target="_blank" rel="noopener">springloaded</a></li>
<li><p>é…ç½®IDEA</p>
<ul>
<li>æ‰“å¼€<code>Run/Debug Configuations</code>,åœ¨<code>Defaults</code>ä¸­é€‰æ‹©<code>Application</code></li>
<li><p>åœ¨å³è¾¹çš„<code>Configuration</code> tabä¸­é…ç½®<code>VM options</code></p>
<pre><code>-javaagent:/Users/bohr/software/springloaded/springloaded-1.2.3.RELEASE.jar -noverify
</code></pre><p>æœ‰äº†æ­¤é»˜è®¤é…ç½®ï¼Œä¸€åŠ³æ°¸é€¸ã€‚ä¸Šé¢çš„è·¯å¾„åœ°å€ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜springloadedçš„è·¯å¾„</p>
</li>
</ul>
</li>
<li>æ‰§è¡Œä»»ä½•javaç±»</li>
<li>ä¿®æ”¹åï¼Œç¼–è¯‘æ­¤javaç±»å°±èƒ½çœ‹åˆ°ä¿®æ”¹åçš„æ•ˆæœäº†ã€‚</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="qiubo" />
            
              <p class="site-author-name" itemprop="name">qiubo</p>
              <p class="site-description motion-element" itemprop="description">Keep running!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">75</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/bohrqiu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:bohrqiu@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i></a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://qiuduo.me/" title="qiuduo" target="_blank">qiuduo</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://thanhong.me/" title="daidai" target="_blank">daidai</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2013 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">qiubo</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
